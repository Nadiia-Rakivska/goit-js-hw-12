{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\n\n\nexport let perPage = 15;\n\nexport async function getImagesByQuery(query, page) {\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const params = new URLSearchParams({\n    q: query,\n    key: '51658185-19ae36e73b0aa030a4154053e',\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page:perPage\n  });\n  const url = `${BASE_URL}${END_POINT}?${params}`;\n  try {\n    const { data } = await axios.get(url);\n    return data;\n  } catch (err) {\n    return err;\n  }\n}\n","\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { refs } from '../main';\n\n\n   let simpleLightbox;\nexport function createGallery(images){\n  const markup = images\n    .map(\n      e =>\n        `<li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${e.largeImageURL}\">\n      <img\n        class=\"gallery-image\"\n        src=\"${e.webformatURL}\"\n        alt=\"${e.tags}\"\n        width=\"360\" height=\"152\"\n      />  </a>\n      <ul class=\"gallery-list\">\n      <li class=\"gallery-item-desc\"><p  class=\"gallery-descr\">Likes</p>\n      <p  class=\"gallery-count\">${e.likes}</p>\n      </li>\n      <li class=\"gallery-item-desc\"><p class=\"gallery-descr\">Views</p>\n      <p class=\"gallery-count\">${e.views}</p>\n      </li>\n      <li class=\"gallery-item-desc\"><p class=\"gallery-descr\">Comments</p>\n      <p class=\"gallery-count\">${e.comments}</p>\n      </li>\n      <li class=\"gallery-item-desc\"><p class=\"gallery-descr\">Downloads</p>\n      <p class=\"gallery-count\">${e.downloads}</p>\n      </li>\n      </ul>\n    </li>`\n    )\n    .join('');\n  refs.galleryElem.insertAdjacentHTML(\"beforeend\", markup)\n\n   if (!simpleLightbox) {\n     simpleLightbox = new SimpleLightbox('.gallery a', {\n       captionsData: 'alt',\n       captionDelay: 250,\n     });\n   } else {\n     simpleLightbox.refresh();\n   }\n}\nexport function clearGallery(){\n  refs.galleryElem.innerHTML = \"\";\n}\nexport function showLoader(){\n  refs.loaderJs.classList.add(\"loader\");\n}\nexport function hideLoader() {\n  refs.loaderJs.classList.remove('loader');\n}\nexport function showLoadMoreButton(){\n  refs.loadMore.classList.add(\"show\");\n}\nexport function hideLoadMoreButton() {\nrefs.loadMore.classList.remove('show');\n}","import { getImagesByQuery, perPage } from './js/pixabay-api';\nimport iziToast from 'izitoast';\n\nimport 'izitoast/dist/css/iziToast.min.css';\nimport {\n  clearGallery,\n  createGallery,\n  hideLoader,\n  hideLoadMoreButton,\n  showLoader,\n  showLoadMoreButton,\n} from './js/render-functions';\n\nexport const refs = {\n  galleryElem: document.querySelector('.gallery'),\n  loaderJs: document.querySelector('.loader-js'),\n  formEl: document.querySelector('.form'),\n  loadMore: document.querySelector('.loadMore'),\n};\nlet page = 1;\nlet query = '';\nlet totalPage = 0;\nlet totalElem = 0;\n\n// refs.formEl.addEventListener('submit', async e => {\n//   e.preventDefault();\n//   query = e.target.elements['search-text'].value.trim();\n//   clearGallery();\n//   hideLoadMoreButton();\n//   page = 1;\n//   showLoader();\n//   if (query.length === 0) {\n//     iziToast.warning({\n//       message: 'Please enter a search query!',\n//       position: 'topRight',\n//     });\n//     return;\n//   }\n\n//   try {\n//     const images = await getImagesByQuery(query, page);\n//     totalElem = images.totalHits;\n//     totalPage = Math.ceil(totalElem / perPage);\n//     if (images.hits.length > 0) {\n//       createGallery(images.hits);\n//       if (images.hits.length > 0 && totalPage > page) {\n//         console.log(images.hits.length);\n//         showLoadMoreButton();\n//       }\n//     } else {\n//       iziToast.error({\n//         message:\n//           'Sorry, there are no images matching your search query. Please try again!',\n//         position: 'topRight',\n//         icon: 'error',\n//         backgroundColor: '#ef4040',\n//         iconColor: 'white',\n//         messageColor: 'white',\n//       });\n//       hideLoadMoreButton();\n//     }\n//   } catch (error) {\n//     iziToast.error({\n//       message: `Error: ${error}`,\n//       position: 'topRight',\n//       icon: 'error',\n//       backgroundColor: '#ef4040',\n//       iconColor: 'white',\n//       messageColor: 'white',\n//     });\n//   }\n\n//   hideLoader();\n//   e.target.reset();\n// });\n// refs.loadMore.addEventListener('click', async () => {\n//   hideLoadMoreButton();\n//   showLoader();\n//   page += 1;\n//   try {\n//     const images = await getImagesByQuery(query, page);\n//     totalElem = images.totalHits;\n//     totalPage = Math.ceil(totalElem / perPage);\n//     if (images.hits.length > 0) {\n//       createGallery(images.hits);\n//       const cardElems = document.querySelectorAll('.gallery-item');\n//       const cardElem = cardElems[cardElems.length - 1];\n//       let rect = cardElem.getBoundingClientRect();\n//       window.scrollBy({\n//         top: rect.height * 2,\n//         behavior: 'smooth',\n//       });\n//     } else {\n//       hideLoadMoreButton();\n//     }\n//     if (totalPage <= page) {\n//       hideLoadMoreButton();\n//       iziToast.info({\n//         message: `We're sorry, but you've reached the end of search results.`,\n//       });\n//       return;\n//     } else {\n//       showLoadMoreButton();\n//     }\n//   } catch {\n//     iziToast.error({\n//       message: 'Download error',\n//       position: 'topRight',\n//       icon: 'error',\n//       backgroundColor: '#ef4040',\n//       iconColor: 'white',\n//       messageColor: 'white',\n//     });\n//   }\n\n  \n//   hideLoader();\n// });\nrefs.formEl.addEventListener('submit', async e => {\n  e.preventDefault();\n  query = e.target.elements['search-text'].value.trim();\n  clearGallery();\n  hideLoadMoreButton();\n  page = 1;\n  showLoader();\n\n  if (!query) {\n    iziToast.warning({\n      message: 'Please enter a search query!',\n      position: 'topRight',\n    });\n    hideLoader();\n    return;\n  }\n\n  try {\n    const images = await getImagesByQuery(query, page);\n    totalElem = images.totalHits;\n    totalPage = Math.ceil(totalElem / perPage);\n\n    if (!images.hits.length) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query.',\n        position: 'topRight',\n        icon: 'error',\n        backgroundColor: '#ef4040',\n        iconColor: 'white',\n        messageColor: 'white',\n      });\n      hideLoadMoreButton();\n      return;\n    }\n\n    createGallery(images.hits);\n\n    if (totalPage > page) {\n      showLoadMoreButton();\n    }\n  } catch (error) {\n    iziToast.error({\n      message: `Error: ${error}`,\n      position: 'topRight',\n      icon: 'error',\n      backgroundColor: '#ef4040',\n      iconColor: 'white',\n      messageColor: 'white',\n    });\n  }\n    hideLoader();\n    e.target.reset();\n  \n});\n\nrefs.loadMore.addEventListener('click', async () => {\n  hideLoadMoreButton();\n  showLoader();\n  page += 1;\n\n  try {\n    const images = await getImagesByQuery(query, page);\n    totalElem = images.totalHits;\n    totalPage = Math.ceil(totalElem / perPage);\n\n    if (!images.hits.length) {\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n      return;\n    }\n\n    createGallery(images.hits);\n\n    const cardElems = document.querySelectorAll('.gallery-item');\n    const cardElem = cardElems[cardElems.length - 1];\n    if (cardElem) {\n      window.scrollBy({\n        top: cardElem.getBoundingClientRect().height * 2,\n        behavior: 'smooth',\n      });\n    }\n\n    if (totalPage > page) {\n      showLoadMoreButton();\n    } else {\n      iziToast.info({\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n      });\n    }\n  } catch {\n    iziToast.error({\n      message: 'Download error',\n      position: 'topRight',\n      icon: 'error',\n      backgroundColor: '#ef4040',\n      iconColor: 'white',\n      messageColor: 'white',\n    });\n  } \n    hideLoader();\n  \n});"],"names":["perPage","getImagesByQuery","query","page","BASE_URL","END_POINT","params","url","data","axios","err","simpleLightbox","createGallery","images","markup","e","refs","SimpleLightbox","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","totalPage","totalElem","iziToast","error","cardElems","cardElem"],"mappings":"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"}